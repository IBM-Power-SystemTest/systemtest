{% extends 'pts/base_table.html' %}

{% load measures %}
{% load types %}

{% block subtitle %} Close {% endblock subtitle %}

{% block table_title %} Historial {% endblock table_title %}

{% block columns %}
  {% to_list "Folio" "Status" "Fecha" "Turno" "Parte" "Serial" "Descripcion" "NCM Tag" "Sistema" "Celda" "Usuario" as column_names %}
  {% include 'utils/tables/column_names.html' with column_names=column_names %}
  {% block extra_columns %} {% endblock extra_columns %}
{% endblock columns %}

{% block table_body %}
  {% for request in object_list %}
    <tr class="table__row">
      <td> {{ request.request.pk }} </td>
      <td> {{ request.request_status }} </td>
      <td> {{ request.created }} </td>
      <td> {{ request.created | get_shift }}</td>
      <td> {{ request.part_number }} </td>
      <td> {{ request.serial_number | default_if_none:"" }} </td>
      <td> {{ request.request.request_group.part_description }} </td>

      <td>
        {% if request.request_status.name == "CLOSE BAD" %}
          {{ request.request.ncm_tag }}
        {% endif %}
      </td>

      <td> {{ request.request.request_group.system_number }} </td>
      <td> {{ request.request.request_group.system_cell }} </td>
      <td> {{ request.user }} </td>
    </tr>
  {% endfor %}
{% endblock table_body %}

{% block button %} {% endblock button %}

<div class="pagination">
  <span class="step-links">
    {% if page_obj.has_previous %}
      <a href="?page=1">&laquo; first</a>
      <a href="?page={{ page_obj.previous_page_number }}">previous</a>
    {% endif %}

    <span class="current">
      Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
    </span>

    {% if page_obj.has_next %}
      <a href="?page={{ page_obj.next_page_number }}">next</a>
      <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
    {% endif %}
  </span>
</div>
